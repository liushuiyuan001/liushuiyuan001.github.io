<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器原理篇 | liushuiyuan's Blog</title>
    <meta name="description" content="我的vitepress博客.">
    <link rel="stylesheet" href="/assets/style.cac40d77.css">
    <link rel="modulepreload" href="/assets/Home.3420caf6.js">
    <link rel="modulepreload" href="/assets/app.6ce202a8.js">
    <link rel="modulepreload" href="/assets/js_Http304.md.ae94e650.lean.js">
    <link rel="modulepreload" href="/assets/app.6ce202a8.js">
    <link rel="icon" href="/img/linktolink.png">
    <meta name="twitter:title" content="浏览器原理篇 | liushuiyuan&#39;s Blog">
    <meta property="og:title" content="浏览器原理篇 | liushuiyuan&#39;s Blog">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="liushuiyuan&#39;s Blog, back to home" data-v-675d8756 data-v-4a583abe><!----> liushuiyuan&#39;s Blog</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>首页 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/about/" data-v-b8818f8c>关于 <!----></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>首页 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/about/" data-v-b8818f8c>关于 <!----></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/">Vue</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/PROP1">Vue组件间传值(上)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/PROP2">Vue组件间传值(下)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/vue/PAGE">页面间传值</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/BASE">JS</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/js/Map">Map</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/Code">手写代码</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/Performance">性能优化</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/Brower">浏览器原理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/js/Http304">浏览器缓存</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/js/Interview">面试</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/design/index">Head First Design</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/design/chapter01">策略模式</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/design/chapter02">观察者模式</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/design/chapter03">装饰者模式</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/design/chapter04">简单工厂</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/design/chapter05">抽象工厂模式</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/design/chapter06">命令模式</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h3 id="浏览器原理篇" tabindex="-1">浏览器原理篇 <a class="header-anchor" href="#浏览器原理篇" aria-hidden="true">#</a></h3><br><h4 id="_1-浏览器缓存" tabindex="-1">1. 浏览器缓存 <a class="header-anchor" href="#_1-浏览器缓存" aria-hidden="true">#</a></h4><p><img src="/assets/http304.dd7970f0.png" alt="http304"></p><ol><li>是否禁止缓存</li></ol><p><strong>禁止缓存</strong>指的市缓存中不得存储任何关于客户端请求和服务端响应的内容。每次由客户端发起的请求都会下载完整的响应内容。</p><p><s>在请求头中，Cache-Control：no-store与Pragma：no-cache都可以禁止缓存，但两者也有区别，Pragma：no-cache可以兼容httt1.0，而Cache-Control：no-store是http1.1提供的。因此，Pragma: no-cache 可以应用到http1.0和http1.1，而Cache-Control：no-store只能应用于http1.1</s></p><p>在请求头中，Cache-Control：no-store 表示禁用缓存。Pragma：no-cache 表示无论在HTTP1.0还是HTTP1.1中，都表示每次发送请求时，都需要向资源服务器确认本地副本的有效性。</p><ol start="2"><li>是否检查本地副本是否过期</li></ol><p>是否检查本地版本是否过期主要由Cache-Control的no-cache和must-revalidate这两个可选值控制，其中：</p><blockquote><ul><li>no-cache：告诉浏览器、缓存服务器，不管本地副本是否过期，使用资源副本前，一定要到源服务器进行副本有效性校验</li><li>Must-revalidate: 告诉浏览器’、缓存服务器，本地副本过期前，可以使用本地副本；本地副本一旦过期，必须去源服务器进行有效性校验。</li></ul></blockquote><ol start="3"><li><p>本地副本是否过期</p><p>想要知道本地副本是否过期，我们就需要了解缓存的过期机制：</p><ol><li><p>过期中机制中，最重要的指令是max-age，它表示资源能够被缓存的最大时间；它通常会和must-revalidate一起使用，使用起来就像下面这样：</p><p><code>Cache-Control:max-age=60,must-revalidate</code></p></li><li><p>如果不含有max-age属性，则会去查看是否包含Expires属性，通过比较Expires的值和返回头里的Date属性的值来判断是否缓存还有效。</p></li><li><p><s>如果max-age和expires属性都没有，找找头里的Last-Modified信息。如果有，缓存的寿命就等于头里面Data的值减去Last-Modified的值除以10(注：根据rfc2626其实也就是乘以10%)</s></p></li></ol></li><li><p>如果本地副本没有过期</p></li></ol><p>如果本地副本没有过期，则会直接从缓存中读取资源，并返回200状态。网络中会显示 from memory cache</p><ol start="5"><li><p>如果本地副本过期</p><p>如果本地副本过期，则会进行到源服务器进行有效性校验的前期准备。</p><p>首先，会在请求头里寻找If-None-Match（&quot;e3333333sas-sas-sasa&quot;）字段，其值为服务器上次返回的Etag响应头的值</p><p>如果请求头里没有If-None-Match字段，则会在请求头中寻找If-Modified-Since字段，其值为服务器上次返回的Last-Modified响应头中的日期值：</p><p>如果If-None-Match与If-Modified-Since都没有，则会直接向服务器请求数据。</p></li><li><p>到源服务器进行有效性校验</p><p>如果请求投中带有If-None-Match 或 If-Modified-Sinece，则会到源服务器进行有效性校验，如果源服务器没有变化，则会返回304；如果有变化，则返回200</p></li><li><p>私有缓存和公共缓存</p><p>在Cache-Control还有两值：private与public，其中：</p><p>public指令表示改响应可以被任何中间人(比如中间代理、CDN等)缓存。若指定了public，则一些通常不被中间人缓存的页面(因为默认是private)(比如带有HTTP验证消息)的页面或某些特定影响状态码的页面，将会被缓存。</p><p>而private则表示该响应是专用与某个用户的，中间人不能缓存此响应，该响应只能应用于浏览器私有缓存中</p></li><li><p>刷新操作方式，对缓存的影响</p><ol><li><p>正常操作</p><p>地址栏输入url，跳转连接，前进后退等。强制缓存有效，协商缓存有效</p></li><li><p>手动刷新</p><p>F5，点击刷新按钮，右键菜单刷新。强制缓存失效，协商缓存有效</p></li><li><p>强制刷新</p><p>ctr+F5 强制缓存失效，协商缓存失效</p></li></ol></li></ol></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/js/Brower" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>浏览器原理</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/js/Interview" data-v-38ede35f><span class="text" data-v-38ede35f>面试</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"9ed520a8\",\"about_index.md\":\"f8c589bb\",\"design_chapter01.md\":\"b834a465\",\"design_chapter02.md\":\"6c0ac110\",\"design_chapter03.md\":\"a90d68fc\",\"design_chapter04.md\":\"17cd95e4\",\"design_chapter05.md\":\"98782f3b\",\"design_chapter06.md\":\"86364589\",\"design_index.md\":\"0dbb29a6\",\"js_base.md\":\"793c530c\",\"js_brower.md\":\"524cbfd6\",\"js_code.md\":\"0842dc11\",\"js_http304.md\":\"ae94e650\",\"js_interview.md\":\"d66c10ad\",\"js_map.md\":\"f1925764\",\"js_performance.md\":\"4d51936f\",\"vue_page.md\":\"ab1b66c7\",\"vue_prop1.md\":\"596a6928\",\"vue_prop2.md\":\"6a31286d\",\"vue_index.md\":\"8b391132\"}")</script>
    <script type="module" async src="/assets/app.6ce202a8.js"></script>
  </body>
</html>